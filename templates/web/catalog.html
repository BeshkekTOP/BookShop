{% extends 'web/base.html' %}
{% block title %}–ö–∞—Ç–∞–ª–æ–≥ ‚Äî –ö–Ω–∏–∂–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω{% endblock %}
{% block content %}
<h1>–ö–∞—Ç–∞–ª–æ–≥</h1>

<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
<form method="get" style="margin-bottom: 20px; padding: 16px; background-color: #f9fafb; border-radius: 8px;">
	<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 12px;">
		<div>
			<label for="q" style="display: block; margin-bottom: 4px; font-weight: 500;">–ü–æ–∏—Å–∫:</label>
			<input type="text" name="q" id="q" value="{{ q }}" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ, ISBN –∏–ª–∏ –∞–≤—Ç–æ—Ä" 
			       style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;" />
		</div>
		<div>
			<label for="category" style="display: block; margin-bottom: 4px; font-weight: 500;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
			<select name="category" id="category" style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;">
				<option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
				{% for cat in categories %}
				<option value="{{ cat.slug }}" {% if request.GET.category == cat.slug %}selected{% endif %}>
					{{ cat.name }}
				</option>
				{% endfor %}
			</select>
		</div>
		<div>
			<label for="price_min" style="display: block; margin-bottom: 4px; font-weight: 500;">–¶–µ–Ω–∞ –æ—Ç:</label>
			<input type="number" name="price_min" id="price_min" value="{{ request.GET.price_min }}" 
			       placeholder="0" min="0" style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;" />
		</div>
		<div>
			<label for="price_max" style="display: block; margin-bottom: 4px; font-weight: 500;">–¶–µ–Ω–∞ –¥–æ:</label>
			<input type="number" name="price_max" id="price_max" value="{{ request.GET.price_max }}" 
			       placeholder="10000" min="0" style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;" />
		</div>
		<div>
			<label for="rating_min" style="display: block; margin-bottom: 4px; font-weight: 500;">–†–µ–π—Ç–∏–Ω–≥ –æ—Ç:</label>
			<input type="number" name="rating_min" id="rating_min" value="{{ request.GET.rating_min }}" 
			       placeholder="0" min="0" max="5" step="0.1" style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;" />
		</div>
	</div>
	<button type="submit" class="btn" style="padding: 10px 24px;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
	<a href="{% url 'catalog' %}" class="btn small" style="background: #6b7280;">–°–±—Ä–æ—Å–∏—Ç—å</a>
</form>

<!-- –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ -->
<div class="grid">
	{% for b in books %}
	<article class="card">
		<header>
			<a href="/books/{{ b.id }}/"><strong>{{ b.title }}</strong></a>
		</header>
		<p style="margin:.5rem 0;color:var(--muted)">{{ b.category.name }}</p>
		<div style="margin:.5rem 0">
			<strong style="font-size: 1.1em; color: #2563eb;">{{ b.price }} ‚ÇΩ</strong>
			{% if b.avg_rating %}
			<span style="color: #f59e0b;">‚≠ê {{ b.avg_rating|floatformat:1 }}</span>
			{% endif %}
		</div>
		<p><a href="/books/{{ b.id }}/" class="btn small">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a></p>
	</article>
	{% empty %}
	<div style="padding: 40px; text-align: center; color: #6b7280;">
		<p>üìö –ö–Ω–∏–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
		<p style="margin-top: 8px; font-size: 0.9em;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã</p>
	</div>
	{% endfor %}
</div>
{% endblock %}
