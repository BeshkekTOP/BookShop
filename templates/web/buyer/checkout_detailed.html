{% extends 'web/base.html' %}
{% block title %}–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞{% endblock %}
{% block content %}
<div style="max-width: 1000px; margin: 0 auto; padding: 20px;">
	<h1>üì¶ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>
	
	<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
		<!-- –§–æ—Ä–º–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ -->
		<div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
			<h2 style="margin: 0 0 15px 0;">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</h2>
			
			<form method="post" id="checkout-form">
				{% csrf_token %}
				
				<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ -->
				<div style="margin-bottom: 20px;">
					<h3 style="margin: 0 0 15px 0; color: #374151;">üìç –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ</h3>
					
					<div style="margin-bottom: 15px;">
						<label style="display: block; margin-bottom: 5px; font-weight: 600;">–ì–æ—Ä–æ–¥ *</label>
						<input type="text" name="shipping_city" value="{{ profile.city|default:'' }}" required 
						       style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;"
						       placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏">
					</div>
					
					<div style="margin-bottom: 15px;">
						<label style="display: block; margin-bottom: 5px; font-weight: 600;">–ê–¥—Ä–µ—Å *</label>
						<textarea name="shipping_address" rows="3" required 
						          style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;"
						          placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞">{{ profile.address|default:'' }}</textarea>
					</div>
					
					<div style="margin-bottom: 15px;">
						<label style="display: block; margin-bottom: 5px; font-weight: 600;">–ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å</label>
						<input type="text" name="shipping_postal_code" value="{{ profile.postal_code|default:'' }}" 
						       style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;"
						       placeholder="123456">
					</div>
				</div>
				
				<!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
				<div style="margin-bottom: 20px;">
					<h3 style="margin: 0 0 15px 0; color: #374151;">üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
					
					<div style="margin-bottom: 15px;">
						<label style="display: block; margin-bottom: 5px; font-weight: 600;">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É</label>
						<textarea name="notes" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –∫—É—Ä—å–µ—Ä–∞, –æ—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –¥–æ—Å—Ç–∞–≤–∫–µ..." 
						          style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;"></textarea>
					</div>
				</div>
				
				<!-- –ö–Ω–æ–ø–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è -->
				<div style="margin-top: 25px;">
					<button type="submit" class="btn" style="width: 100%; font-size: 1.1em; padding: 15px; background: #10b981; border: none; color: white; border-radius: 8px; cursor: pointer; transition: background 0.2s;"
					        onmouseover="this.style.background='#059669'" onmouseout="this.style.background='#10b981'">
						‚úÖ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ {{ total }} ‚ÇΩ
					</button>
				</div>
			</form>
		</div>
		
		<!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
		<div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; height: fit-content;">
			<h2 style="margin: 0 0 15px 0;">–í–∞—à –∑–∞–∫–∞–∑</h2>
			
			{% for item_data in items %}
			<div style="padding: 10px 0; border-bottom: 1px solid #e5e7eb;">
				<p style="margin: 0; font-weight: 600;">{{ item_data.item.book.title }}</p>
				<p style="margin: 5px 0; color: #6b7280; font-size: 0.9em;">
					{{ item_data.item.quantity }} √ó {{ item_data.item.book.price }} ‚ÇΩ
				</p>
				<p style="margin: 5px 0 0 0; text-align: right; font-weight: 600;">
					{{ item_data.total }} ‚ÇΩ
				</p>
			</div>
			{% endfor %}
			
			<div style="border-top: 2px solid #e5e7eb; margin-top: 15px; padding-top: 15px;">
				<p style="margin: 0; font-size: 1.3em; font-weight: 600; color: #2563eb;">
					–ò—Ç–æ–≥–æ: {{ total }} ‚ÇΩ
				</p>
			</div>
		</div>
	</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('checkout-form');
    const submitBtn = form.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    
    form.addEventListener('submit', function(e) {
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        const city = form.querySelector('input[name="shipping_city"]').value.trim();
        const address = form.querySelector('textarea[name="shipping_address"]').value.trim();
        
        if (!city || !address) {
            e.preventDefault();
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
            return;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        submitBtn.innerHTML = '‚è≥ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∑–∞–∫–∞–∑...';
        submitBtn.disabled = true;
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫
        setTimeout(function() {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        }, 10000);
    });
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    const requiredFields = form.querySelectorAll('input[required], textarea[required]');
    requiredFields.forEach(field => {
        field.addEventListener('blur', function() {
            if (this.value.trim() === '') {
                this.style.borderColor = '#ef4444';
                this.style.borderWidth = '2px';
            } else {
                this.style.borderColor = '#10b981';
                this.style.borderWidth = '2px';
            }
        });
        
        field.addEventListener('input', function() {
            if (this.value.trim() !== '') {
                this.style.borderColor = '#10b981';
                this.style.borderWidth = '2px';
            }
        });
    });
});
</script>
{% endblock %}

