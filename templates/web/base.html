{% load static %}
<!doctype html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>{% block title %}–ö–Ω–∏–∂–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω{% endblock %}</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/modern-normalize/modern-normalize.css">
	<link rel="stylesheet" href="{% static 'styles.css' %}">
	{% block extra_head %}{% endblock %}
</head>
<body class="light" 
	  data-is-authenticated="{% if request.user.is_authenticated %}true{% else %}false{% endif %}"
	  data-is-staff="{% if request.user.is_staff %}true{% else %}false{% endif %}">
	<header class="header">
		<div class="nav container">
			<ul class="nav-left">
				<li class="brand"><a href="/">Bookstore</a></li>
				<li><a href="/catalog/">–ö–∞—Ç–∞–ª–æ–≥</a></li>
				<li><a href="/cart/">–ö–æ—Ä–∑–∏–Ω–∞</a></li>
				{% if request.user.is_authenticated %}
					{% if request.user.profile.role == 'admin' or request.user.is_staff %}
					<li class="dropdown">
						<a href="#">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚ñæ</a>
						<ul class="dropdown-menu">
							<li><a href="/admin/dashboard/">üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</a></li>
							<li><hr style="margin: 5px 0;"></li>
							<li><a href="/admin/users/">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a></li>
							<li><a href="/admin/books/">üìö –ö–Ω–∏–≥–∏</a></li>
							<li><a href="/admin/authors/">‚úçÔ∏è –ê–≤—Ç–æ—Ä—ã</a></li>
							<li><a href="/admin/categories/">üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
							<li><a href="/admin/inventory/">üì¶ –û—Å—Ç–∞—Ç–∫–∏</a></li>
							<li><hr style="margin: 5px 0;"></li>
							<li><a href="/admin/reports/">üìà –û—Ç—á–µ—Ç—ã</a></li>
							<li><a href="/admin/logs/">üìù –õ–æ–≥–∏</a></li>
						</ul>
					</li>
					{% elif request.user.profile.role == 'manager' %}
					<li class="dropdown">
						<a href="#">–ú–µ–Ω–µ–¥–∂–µ—Ä ‚ñæ</a>
						<ul class="dropdown-menu">
							<li><a href="/manager/">üìä –ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞</a></li>
							<li><hr style="margin: 5px 0;"></li>
							<li><a href="/manager/orders/">üìã –ó–∞–∫–∞–∑—ã</a></li>
							<li><a href="/manager/statistics/">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></li>
						</ul>
					</li>
					{% endif %}
				{% endif %}
			</ul>
			<ul class="nav-right">
				<li>
					<button id="help-btn" class="btn-ghost" style="padding: 4px 8px; font-size: 1.2em; border: 1px solid var(--border); border-radius: 6px; cursor: pointer; background: var(--card);" title="–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ (Ctrl+?)">‚å®Ô∏è</button>
				</li>
				{% if request.user.is_authenticated %}
				<li><a href="/orders/">üì¶ –ó–∞–∫–∞–∑—ã</a></li>
				<li><a href="/profile/">{{ request.user.username }}</a></li>
				<li><a class="btn btn-ghost" href="/logout/">–í—ã—Ö–æ–¥</a></li>
				{% else %}
				<li><a class="btn btn-ghost" href="/login/">–í—Ö–æ–¥</a></li>
				<li><a class="btn" href="/register/">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
				{% endif %}
			</ul>
		</div>
	</header>
	<main class="container main">
		{% for message in messages %}
		<div class="alert">{{ message }}</div>
		{% endfor %}
		{% block content %}{% endblock %}
	</main>
	<script src="{% static 'keyboard.js' %}"></script>
	<script src="{% static 'theme.js' %}"></script>
	<script>
		// –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–º–æ—â–∏ –∫ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫
		(function() {
			const helpBtn = document.getElementById('help-btn');
			if (helpBtn) {
				helpBtn.addEventListener('click', function(e) {
					e.preventDefault();
					e.stopPropagation();
					if (window.KeyboardShortcuts && typeof window.KeyboardShortcuts.showHelp === 'function') {
						window.KeyboardShortcuts.showHelp();
					} else {
						alert('–ú–æ–¥—É–ª—å –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
					}
				});
			}
		})();
	</script>
	{% block extra_scripts %}{% endblock %}
</body>
</html>
